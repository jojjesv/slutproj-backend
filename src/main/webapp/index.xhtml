<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:p="http://primefaces.org/ui">
  <h:head>
    <title>Super Secret Admin Panel - Foodi</title>
    <style type="text/css">
      .recipe-item {

      }

      .recipe-item .image {
        width: 100%;
        height: 160px;
        background-size: cover;
        background-position: center;
      }

      td {
        vertical-align: top;
      }

      .ui-panelgrid td,
      .ui-panelgrid tr{
        border: none !important;
      }

      .ui-datagrid-column {
        width: 50%;
      }
    </style>

    <style type="text/css">
      .ui-datagrid-no-border>.ui-datagrid-content {
        border: none;
      }	
    </style>
  </h:head>
  <h:body>
    <div class="ui-grid">
      <div class="ui-grid-col-6">
        <h:form pt:method="GET">
          <h:commandButton action="#{recipeBean.createRecipe()}" value="New recipe" />

          <p:dataGrid value="#{recipeBean.recipes}" var="recipe" columns="2" styleClass="recipe-list">
            <div class="recipe-item">
              <h:commandLink action="#{recipeBean.setSelectedRecipe(recipe)}">
                <div style="background-image:url(#{recipe.imageUrl})" class="image">
                </div>
                <h:outputText
                  value="#{recipe.name == null || recipe.name.length() == 0 ? 'Untitled recipe' : recipe.name}"
                  styleClass="name" />
              </h:commandLink>
            </div>
          </p:dataGrid>

          <h:outputText value="We have #{recipeBean.recipes.size()} recipes!" />
        </h:form>   

      </div>

      <div class="ui-grid-col-6">
        <c:if test="#{recipeBean.selectedRecipe != null}">
          <h2>Basic info</h2>

          <h:form pt:method="GET">
            <div>
              <div class="ui-grid-col-6">
                <div>
                  <div>
                    <p:outputLabel for="input-name" value="Name" />
                  </div>
                  <div>
                    <p:inputText id="input-name"
                                 value="#{recipeBean.selectedRecipe.name}">
                      <p:ajax />
                    </p:inputText>
                  </div>
                </div>
                <div>
                  <div>
                    <p:outputLabel for="input-categories" value="Categories" />
                  </div>
                  <div>
                    <p:inputText id="input-categories"
                                 value="#{recipeBean.selectedRecipe.categoriesString}">
                      <p:ajax />
                    </p:inputText>
                  </div>
                </div>
                <div>
                  <div>
                    <p:outputLabel for="input-ingredients" value="Ingredients" />
                  </div>
                  <div>
                    <p:inputText id="input-ingredients"
                                 value="#{recipeBean.selectedRecipe.ingredientsString}">
                      <p:ajax />
                    </p:inputText>
                  </div>
                </div>
              </div>
              <div class="ui-grid-col-6">
                <div>
                  <p:outputLabel for="input-description" value="Description" />
                </div>
                <div>
                  <p:inputTextarea id="input-description"
                                   value="#{recipeBean.selectedRecipe.description}"
                                   rows="4">
                    <p:ajax />
                  </p:inputTextarea>
                </div>
                <div>
                  <!--
                  <p:fileUpload mode="simple" value="#{recipeBean.uploadedFile}"/>
                  -->
                  <p:growl id="messages" showDetail="true" />     
                </div>
              </div>

              <div class="ui-grid-col-12">
                <div>
                  <h2>Steps <p:commandLink action="#{recipeBean.addStep()}">+</p:commandLink></h2>
                </div>
                <p:dataGrid columns="1" var="step" value="#{recipeBean.selectedRecipe.stepCollection}"
                            styleClass="ui-datagrid-no-border">
                  <p:row>
                    <p:inputText value="#{step.text}" />
                  </p:row>
                </p:dataGrid>
              </div>
              <div class="ui-grid-col-12">
                <h:commandButton value="Update recipe" action="#{recipeBean.updateRecipe}" />
              </div>
            </div>

            <p:messages />

          </h:form>
        </c:if>
      </div>
    </div>

  </h:body>
</html>
